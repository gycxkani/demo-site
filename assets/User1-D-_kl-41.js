import{u as G,r as p,a as w,c as B,o as b,b as I,d as $,e as o,w as n,f as l,g as f,t as _,n as x,s as J,F as C,p as K,q as Q,ah as X,aU as R,x as Y,E as Z,j as ee,aj as le,z as ae,y as te}from"./index-B2sUpHKW.js";import{E as oe}from"./el-dialog-BUexGnmh.js";import{a as ne,E as se}from"./el-form-item-JDeCQ2vQ.js";import{l as re,u as ie,s as de,a as ue}from"./sys-user-_i6ztfEw.js";const me={class:"main-body"},ce={class:"toolbar"},be={__name:"User1",setup(pe){const{t:e}=G(),g=p(),D=[{type:"edit",show:a=>a.createdBy!=="system"},{type:"delete",show:a=>a.createdBy!=="system"}],h=w({name:""}),u=p(!1),i=p(!1),y=p(!1),V=p(),s=w({id:"",name:"",roleId:""}),E={...s},P=B(()=>[{type:"selection",selectable:W},{prop:"id",label:e("thead.ID"),minWidth:50},{prop:"name",label:e("thead.username"),minWidth:120},{prop:"roleName",label:e("thead.group"),minWidth:120},{prop:"createdBy",label:e("thead.createdBy"),minWidth:120},{prop:"ip",label:e("thead.latestIp"),minWidth:100},{prop:"visitTime",label:e("thead.latestVisit"),minWidth:120}]),U=B(()=>({name:[{required:!0,message:e("form.usernameHolder"),trigger:["blur","change"]}],roleId:[{required:!0,message:e("form.roleRequired"),trigger:["blur","change"]}]}));function W(a){return a.createdBy!=="system"}function F(){g.value.reload()}function N(){u.value=!0,i.value=!1}function q(a){i.value=!0,u.value=!0;for(const t in s)t in a&&(s[t]=a[t])}function S(a,t){console.log("delete",a,t)}function T(){for(const a in E)s[a]=E[a]}function v(){u.value=!1,T()}function H(){const a={...s};return i.value||delete a.id,a}function j(){V.value.validate(a=>{if(!a)return;y.value=!0;let t;const m=H();i.value?t=ie(m):t=de(m),t.then(d=>{i.value?Y({message:e("tips.success"),type:"success",showClose:!0}):R.alert(`${e("tips.success")}${e("form.username")}: ${d.data.name},${e("form.password")}: ${d.data.password}`,e("tips.title"),{confirmButtonText:e("action.confirm")}),v(),i.value?g.value.refresh():g.value.reload()}).finally(()=>{y.value=!1})})}function L(){ue({...s}).then(a=>{R.alert(`${e("tips.success")}${e("form.username")}: ${a.data.name},${e("form.password")}: ${a.data.password}`,e("tips.title"),{confirmButtonText:e("action.confirm")})})}return(a,t)=>{const m=Z,d=ne,c=ee,k=se,M=le,O=ae,z=te,A=oe;return b(),I(C,null,[$("div",me,[$("div",ce,[o(k,{inline:!0,model:l(h)},{default:n(()=>[o(d,null,{default:n(()=>[o(m,{modelValue:l(h).name,"onUpdate:modelValue":t[0]||(t[0]=r=>l(h).name=r),placeholder:l(e)("thead.username")},null,8,["modelValue","placeholder"])]),_:1}),o(d,null,{default:n(()=>[o(c,{icon:"search",type:"primary",onClick:F},{default:n(()=>[f(_(l(e)("action.search")),1)]),_:1})]),_:1}),o(d,null,{default:n(()=>[o(c,{icon:"plus",type:"primary",onClick:N},{default:n(()=>[f(_(l(e)("action.add")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),o(M,{ref_key:"tableRef",ref:g,"get-page":l(re),filters:l(h),columns:l(P),operations:D,onHandleEdit:q,onHandleDelete:S},null,8,["get-page","filters","columns"])]),o(A,{title:l(i)?l(e)("action.edit"):l(e)("action.add"),modelValue:l(u),"onUpdate:modelValue":t[3]||(t[3]=r=>X(u)?u.value=r:null),draggable:"",width:"40%","close-on-click-modal":!1,onClose:v},{footer:n(()=>[o(c,{onClick:v},{default:n(()=>[f(_(l(e)("action.cancel")),1)]),_:1}),l(i)?(b(),x(c,{key:0,type:"primary",onClick:L},{default:n(()=>[f(_(l(e)("form.resetPassword")),1)]),_:1})):J("",!0),o(c,{type:"primary",onClick:j,loading:l(y)},{default:n(()=>[f(_(l(e)("action.submit")),1)]),_:1},8,["loading"])]),default:n(()=>[o(k,{ref_key:"formRef",ref:V,model:l(s),"label-width":"80px",rules:l(U),"label-position":"right"},{default:n(()=>[o(d,{label:l(e)("form.username"),prop:"name"},{default:n(()=>[o(m,{modelValue:l(s).name,"onUpdate:modelValue":t[1]||(t[1]=r=>l(s).name=r)},null,8,["modelValue"])]),_:1},8,["label"]),o(d,{label:l(e)("form.group"),prop:"roleId"},{default:n(()=>[o(z,{modelValue:l(s).roleId,"onUpdate:modelValue":t[2]||(t[2]=r=>l(s).roleId=r),placeholder:l(e)("form.choose"),style:{width:"100%"}},{default:n(()=>[(b(!0),I(C,null,K(l(Q),r=>(b(),x(O,{key:r.name,label:r.label,value:r.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])],64)}}};export{be as default};
