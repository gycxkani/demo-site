import{a as y,c as V,o as p,b as k,d as E,e as o,w as t,f as e,g as m,t as u,n as w,s as M,F as B,p as O,q as G,ah as J,aU as C,E as K,j as Q,aj as X,z as Y,y as Z}from"./index-B2sUpHKW.js";import{E as ee}from"./el-dialog-BUexGnmh.js";import{a as le,E as oe}from"./el-form-item-JDeCQ2vQ.js";import{l as te,r as ae,s as ne,u as se,a as re}from"./sys-user-_i6ztfEw.js";import{u as de}from"./use-table-handlers-BAT35szp.js";const ie={class:"main-body"},me={class:"toolbar"},he={__name:"User",setup(ue){const c=y({name:""}),r=y({id:"",name:"",roleId:""}),{t:l,tableRef:v,dialogVisible:f,isEdit:_,formLoading:$,formRef:I,doSearch:x,doAdd:R,doEdit:S,doSubmit:U,doRemove:W,doClose:b}=de(r),D=[{type:"edit",show:a=>a.createdBy!=="system"},{type:"delete",show:a=>a.createdBy!=="system"}],H=V(()=>[{type:"selection",selectable:T},{prop:"id",label:l("thead.ID"),minWidth:50},{prop:"name",label:l("thead.username"),minWidth:120},{prop:"roleName",label:l("thead.group"),minWidth:120},{prop:"createdBy",label:l("thead.createdBy"),minWidth:120},{prop:"ip",label:l("thead.latestIp"),minWidth:100},{prop:"visitTime",label:l("thead.latestVisit"),minWidth:120}]),N=V(()=>({name:[{required:!0,message:l("form.usernameHolder"),trigger:["blur","change"]}],roleId:[{required:!0,message:l("form.roleRequired"),trigger:["blur","change"]}]}));function T(a){return a.createdBy!=="system"}function q(a,s){W(ae,a,s)}function F(){U({save:ne,update:se},a=>{_.value||C.alert(`${l("tips.success")}${l("form.username")}: ${a.data.name},${l("form.password")}: ${a.data.password}`,l("tips.title"),{confirmButtonText:l("action.confirm")})})}function P(){re({...r}).then(a=>{C.alert(`${l("tips.success")}${l("form.username")}: ${a.data.name},${l("form.password")}: ${a.data.password}`,l("tips.title"),{confirmButtonText:l("action.confirm")})})}return(a,s)=>{const h=K,d=le,i=Q,g=oe,j=X,L=Y,z=Z,A=ee;return p(),k(B,null,[E("div",ie,[E("div",me,[o(g,{inline:!0,model:e(c)},{default:t(()=>[o(d,null,{default:t(()=>[o(h,{modelValue:e(c).name,"onUpdate:modelValue":s[0]||(s[0]=n=>e(c).name=n),placeholder:e(l)("thead.username")},null,8,["modelValue","placeholder"])]),_:1}),o(d,null,{default:t(()=>[o(i,{icon:"search",type:"primary",onClick:e(x)},{default:t(()=>[m(u(e(l)("action.search")),1)]),_:1},8,["onClick"])]),_:1}),o(d,null,{default:t(()=>[o(i,{icon:"plus",type:"primary",onClick:e(R)},{default:t(()=>[m(u(e(l)("action.add")),1)]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),o(j,{ref_key:"tableRef",ref:v,"get-page":e(te),filters:e(c),columns:e(H),operations:D,onHandleEdit:e(S),onHandleDelete:q},null,8,["get-page","filters","columns","onHandleEdit"])]),o(A,{title:e(_)?e(l)("action.edit"):e(l)("action.add"),modelValue:e(f),"onUpdate:modelValue":s[3]||(s[3]=n=>J(f)?f.value=n:null),draggable:"",width:"40%","close-on-click-modal":!1,onClose:e(b)},{footer:t(()=>[o(i,{onClick:e(b)},{default:t(()=>[m(u(e(l)("action.cancel")),1)]),_:1},8,["onClick"]),e(_)?(p(),w(i,{key:0,type:"primary",onClick:P},{default:t(()=>[m(u(e(l)("form.resetPassword")),1)]),_:1})):M("",!0),o(i,{type:"primary",onClick:F,loading:e($)},{default:t(()=>[m(u(e(l)("action.submit")),1)]),_:1},8,["loading"])]),default:t(()=>[o(g,{ref_key:"formRef",ref:I,model:e(r),"label-width":"80px",rules:e(N),"label-position":"right"},{default:t(()=>[o(d,{label:e(l)("form.username"),prop:"name"},{default:t(()=>[o(h,{modelValue:e(r).name,"onUpdate:modelValue":s[1]||(s[1]=n=>e(r).name=n)},null,8,["modelValue"])]),_:1},8,["label"]),o(d,{label:e(l)("form.group"),prop:"roleId"},{default:t(()=>[o(z,{modelValue:e(r).roleId,"onUpdate:modelValue":s[2]||(s[2]=n=>e(r).roleId=n),placeholder:e(l)("form.choose"),style:{width:"100%"}},{default:t(()=>[(p(!0),k(B,null,O(e(G),n=>(p(),w(L,{key:n.name,label:n.label,value:n.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue","onClose"])],64)}}};export{he as default};
