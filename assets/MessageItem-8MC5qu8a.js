import{aT as h,r as k,u as A,a as q,bp as w,k as I,f as l,o as m,b as v,d as a,e as d,w as g,g as y,t as r,F as U,p as V,x as f,aU as F,j,Z as D,bq as L,bo as Z}from"./index-B2sUpHKW.js";const G=e=>{const s=e.type;return delete e.type,h({url:`/message/list/${s}`,method:"get",data:e})},H=e=>{const{id:s,type:t}=e;return delete e.id,delete e.type,h({url:`/message/read/${t}/${s}`,method:"post",data:e})},J=e=>{const s=e.type;return delete e.type,h({url:`/message/readAll/${s}`,method:"post",data:e})},K=e=>{const{id:s,type:t}=e;return delete e.id,delete e.type,h({url:`/message/${t}/${s}`,method:"delete",data:e})},O={key:0},Q={class:"txt-r"},W={class:"events"},X={class:"label"},Y={class:"content"},ee={class:"summary"},te={class:"date"},se={class:"extra text"},ne={class:"actions"},oe={class:"flex-center"},ae={key:1},le={class:"nodata txt-c"},ie={__name:"MessageItem",props:{type:String},setup(e){const s=k([]),{t}=A(),C=e,i=q({pageNum:1,pageSize:20}),x=k(0),_=w(C,"type"),p=()=>{const{pageNum:c,pageSize:n}=i;G({type:_.value,pageNum:c,pageSize:n}).then(u=>{s.value=u.data.content||[],x.value=u.data.totalSize||0}).catch(()=>{s.value=[]})},z=c=>{H({type:_.value,id:c}).then(()=>{f.success(t("tips.success")),p()})},S=()=>{J({type:_.value}).then(()=>{f.success(t("tips.success")),p()})},b=c=>{F.confirm(t("tips.deleteConfirm"),t("tips.deleteTitle"),{confirmButtonText:t("action.confirm"),cancelButtonText:t("action.cancel"),type:"warning",draggable:!0}).then(()=>{K({type:_.value,id:c}).then(()=>{f.success(t("tips.success")),p()})})};function N(c){i.pageSize=c,i.pageNum=1,p()}function $(c){i.pageNum=c,p()}return p(),(c,n)=>{const u=j,B=I("comment"),E=D,M=L,R=Z;return l(s).length?(m(),v("div",O,[a("div",Q,[d(u,{plain:"",type:"primary",onClick:n[0]||(n[0]=o=>S())},{default:g(()=>[y(r(l(t)("action.markedAllRead")),1)]),_:1})]),a("div",W,[(m(!0),v(U,null,V(l(s),(o,P)=>(m(),v("div",{class:"event",key:P},[a("div",X,[d(M,{"is-dot":!o.isRead},{default:g(()=>[d(E,null,{default:g(()=>[d(B)]),_:1})]),_:2},1032,["is-dot"])]),a("div",Y,[a("div",ee,[y(r(o.title)+" ",1),a("div",te,r(o.date),1)]),a("div",se,r(o.content),1),a("div",ne,[d(u,{type:"",disabled:o.isRead,class:"action a-read",onClick:T=>z(o.id)},{default:g(()=>[n[3]||(n[3]=a("i",{class:"el-icon-edit"},null,-1)),y(" "+r(l(t)("action.markedRead")),1)]),_:2},1032,["disabled","onClick"]),d(u,{type:"",class:"action a-delete",onClick:T=>b(o.id)},{default:g(()=>[n[4]||(n[4]=a("i",{class:"el-icon-delete"},null,-1)),y(" "+r(l(t)("action.delete")),1)]),_:2},1032,["onClick"])])])]))),128))]),a("div",oe,[d(R,{currentPage:l(i).pageNum,"onUpdate:currentPage":n[1]||(n[1]=o=>l(i).pageNum=o),"page-size":l(i).pageSize,"onUpdate:pageSize":n[2]||(n[2]=o=>l(i).pageSize=o),total:l(x)||0,layout:"prev, pager, next",onSizeChange:N,onCurrentChange:$},null,8,["currentPage","page-size","total"])])])):(m(),v("div",ae,[a("div",le,r(l(t)("nodata")),1)]))}}};export{ie as default};
