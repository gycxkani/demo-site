import{ak as se,G as ye,al as Ve,a9 as g,am as Ne,an as fe,ao as ee,ap as K,a6 as x,J as be,aq as _e,M as he,r as ae,a as ue,ar as ge,c as B,a7 as X,as as Ee,at as Ie,m as we,X as Se,Y as ke,o as V,b as z,ad as ie,f as e,Q as ne,ai as q,a4 as Z,e as s,w as m,n as w,au as Ce,av as Te,Z as de,s as O,aw as Ae,a5 as Fe,ax as Pe,ay as oe,E as ve,S as Re,L as De,a8 as xe,az as me,aA as Be,af as Le,aB as Ue,aC as Me,d as re,g as M,t as $,F as pe,p as $e,ah as qe,j as Ke,aj as ze}from"./index-B2sUpHKW.js";import{E as Oe}from"./el-dialog-BUexGnmh.js";import{a as Ge,b as He,E as Ye}from"./el-radio-B1N3araW.js";import{a as je,E as We}from"./el-form-item-JDeCQ2vQ.js";import{l as Je,r as Qe,s as Xe,u as Ze,a as ea}from"./app-resource-Bfu6mpj4.js";import{u as aa}from"./use-table-handlers-BAT35szp.js";const la=100,ta=600,ce={beforeMount(d,E){const p=E.value,{interval:l=la,delay:n=ta}=se(p)?{}:p;let b,v;const u=()=>se(p)?p():p.handler(),_=()=>{v&&(clearTimeout(v),v=void 0),b&&(clearInterval(b),b=void 0)};d.addEventListener("mousedown",C=>{C.button===0&&(_(),u(),document.addEventListener("mouseup",()=>_(),{once:!0}),v=setTimeout(()=>{b=setInterval(()=>{u()},l)},n))})}},na=ye({id:{type:String,default:void 0},step:{type:Number,default:1},stepStrictly:Boolean,max:{type:Number,default:Number.POSITIVE_INFINITY},min:{type:Number,default:Number.NEGATIVE_INFINITY},modelValue:Number,readonly:Boolean,disabled:Boolean,size:Ve,controls:{type:Boolean,default:!0},controlsPosition:{type:String,default:"",values:["","right"]},valueOnClear:{type:[String,Number,null],validator:d=>d===null||g(d)||["min","max"].includes(d),default:null},name:String,placeholder:String,precision:{type:Number,validator:d=>d>=0&&d===Number.parseInt(`${d}`,10)},validateEvent:{type:Boolean,default:!0},...Ne(["ariaLabel"])}),oa={[fe]:(d,E)=>E!==d,blur:d=>d instanceof FocusEvent,focus:d=>d instanceof FocusEvent,[ee]:d=>g(d)||K(d),[x]:d=>g(d)||K(d)},ra=be({name:"ElInputNumber"}),ua=be({...ra,props:na,emits:oa,setup(d,{expose:E,emit:p}){const l=d,{t:n}=_e(),b=he("input-number"),v=ae(),u=ue({currentValue:l.modelValue,userInput:null}),{formItem:_}=ge(),C=B(()=>g(l.modelValue)&&l.modelValue<=l.min),G=B(()=>g(l.modelValue)&&l.modelValue>=l.max),le=B(()=>{const a=Y(l.step);return X(l.precision)?Math.max(Y(l.modelValue),a):(a>l.precision,l.precision)}),L=B(()=>l.controls&&l.controlsPosition==="right"),H=Ee(),S=Ie(),T=B(()=>{if(u.userInput!==null)return u.userInput;let a=u.currentValue;if(K(a))return"";if(g(a)){if(Number.isNaN(a))return"";X(l.precision)||(a=a.toFixed(l.precision))}return a}),A=(a,t)=>{if(X(t)&&(t=le.value),t===0)return Math.round(a);let o=String(a);const c=o.indexOf(".");if(c===-1||!o.replace(".","").split("")[c+t])return a;const k=o.length;return o.charAt(k-1)==="5"&&(o=`${o.slice(0,Math.max(0,k-1))}6`),Number.parseFloat(Number(o).toFixed(t))},Y=a=>{if(K(a))return 0;const t=a.toString(),o=t.indexOf(".");let c=0;return o!==-1&&(c=t.length-o-1),c},j=(a,t=1)=>g(a)?A(a+l.step*t):u.currentValue,F=()=>{if(l.readonly||S.value||G.value)return;const a=Number(T.value)||0,t=j(a);P(t),p(ee,u.currentValue),D()},U=()=>{if(l.readonly||S.value||C.value)return;const a=Number(T.value)||0,t=j(a,-1);P(t),p(ee,u.currentValue),D()},W=(a,t)=>{const{max:o,min:c,step:f,precision:r,stepStrictly:k,valueOnClear:Q}=l;o<c&&De("InputNumber","min should not be greater than max.");let y=Number(a);if(K(a)||Number.isNaN(y))return null;if(a===""){if(Q===null)return null;y=xe(Q)?{min:c,max:o}[Q]:Q}return k&&(y=A(Math.round(y/f)*f,r),y!==a&&t&&p(x,y)),X(r)||(y=A(y,r)),(y>o||y<c)&&(y=y>o?o:c,t&&p(x,y)),y},P=(a,t=!0)=>{var o;const c=u.currentValue,f=W(a);if(!t){p(x,f);return}c===f&&a||(u.userInput=null,p(x,f),c!==f&&p(fe,f,c),l.validateEvent&&((o=_==null?void 0:_.validate)==null||o.call(_,"change").catch(r=>me())),u.currentValue=f)},J=a=>{u.userInput=a;const t=a===""?null:Number(a);p(ee,t),P(t,!1)},h=a=>{const t=a!==""?Number(a):"";(g(t)&&!Number.isNaN(t)||a==="")&&P(t),D(),u.userInput=null},i=()=>{var a,t;(t=(a=v.value)==null?void 0:a.focus)==null||t.call(a)},I=()=>{var a,t;(t=(a=v.value)==null?void 0:a.blur)==null||t.call(a)},N=a=>{p("focus",a)},R=a=>{var t,o;u.userInput=null,Be()&&u.currentValue===null&&((t=v.value)!=null&&t.input)&&(v.value.input.value=""),p("blur",a),l.validateEvent&&((o=_==null?void 0:_.validate)==null||o.call(_,"blur").catch(c=>me()))},D=()=>{u.currentValue!==l.modelValue&&(u.currentValue=l.modelValue)},te=a=>{document.activeElement===a.target&&a.preventDefault()};return we(()=>l.modelValue,(a,t)=>{const o=W(a,!0);u.userInput===null&&o!==t&&(u.currentValue=o)},{immediate:!0}),Se(()=>{var a;const{min:t,max:o,modelValue:c}=l,f=(a=v.value)==null?void 0:a.input;if(f.setAttribute("role","spinbutton"),Number.isFinite(o)?f.setAttribute("aria-valuemax",String(o)):f.removeAttribute("aria-valuemax"),Number.isFinite(t)?f.setAttribute("aria-valuemin",String(t)):f.removeAttribute("aria-valuemin"),f.setAttribute("aria-valuenow",u.currentValue||u.currentValue===0?String(u.currentValue):""),f.setAttribute("aria-disabled",String(S.value)),!g(c)&&c!=null){let r=Number(c);Number.isNaN(r)&&(r=null),p(x,r)}f.addEventListener("wheel",te,{passive:!1})}),ke(()=>{var a,t;const o=(a=v.value)==null?void 0:a.input;o==null||o.setAttribute("aria-valuenow",`${(t=u.currentValue)!=null?t:""}`)}),E({focus:i,blur:I}),(a,t)=>(V(),z("div",{class:ne([e(b).b(),e(b).m(e(H)),e(b).is("disabled",e(S)),e(b).is("without-controls",!a.controls),e(b).is("controls-right",e(L))]),onDragstart:oe(()=>{},["prevent"])},[a.controls?ie((V(),z("span",{key:0,role:"button","aria-label":e(n)("el.inputNumber.decrease"),class:ne([e(b).e("decrease"),e(b).is("disabled",e(C))]),onKeydown:q(U,["enter"])},[Z(a.$slots,"decrease-icon",{},()=>[s(e(de),null,{default:m(()=>[e(L)?(V(),w(e(Ce),{key:0})):(V(),w(e(Te),{key:1}))]),_:1})])],42,["aria-label","onKeydown"])),[[e(ce),U]]):O("v-if",!0),a.controls?ie((V(),z("span",{key:1,role:"button","aria-label":e(n)("el.inputNumber.increase"),class:ne([e(b).e("increase"),e(b).is("disabled",e(G))]),onKeydown:q(F,["enter"])},[Z(a.$slots,"increase-icon",{},()=>[s(e(de),null,{default:m(()=>[e(L)?(V(),w(e(Ae),{key:0})):(V(),w(e(Fe),{key:1}))]),_:1})])],42,["aria-label","onKeydown"])),[[e(ce),F]]):O("v-if",!0),s(e(ve),{id:a.id,ref_key:"input",ref:v,type:"number",step:a.step,"model-value":e(T),placeholder:a.placeholder,readonly:a.readonly,disabled:e(S),size:e(H),max:a.max,min:a.min,name:a.name,"aria-label":a.ariaLabel,"validate-event":!1,onKeydown:[q(oe(F,["prevent"]),["up"]),q(oe(U,["prevent"]),["down"])],onBlur:R,onFocus:N,onInput:J,onChange:h},Pe({_:2},[a.$slots.prefix?{name:"prefix",fn:m(()=>[Z(a.$slots,"prefix")])}:void 0,a.$slots.suffix?{name:"suffix",fn:m(()=>[Z(a.$slots,"suffix")])}:void 0]),1032,["id","step","model-value","placeholder","readonly","disabled","size","max","min","name","aria-label","onKeydown"])],42,["onDragstart"]))}});var sa=Re(ua,[["__file","input-number.vue"]]);const ia=Le(sa),da={class:"main-body"},ma={class:"toolbar"},pa={class:"dialog-footer"},Na={__name:"Resource",setup(d){const E=ae(["folder","menu","button"]),p=ue({name:""}),l=ue({id:"",type:0,name:"",displayName:"",parentId:null,url:"",orderNum:0,icon:""}),{t:n,tableRef:b,dialogVisible:v,isEdit:u,formLoading:_,formRef:C,doSearch:G,doAdd:le,doEdit:L,doRemove:H,doSubmit:S,doClose:T}=aa(l),A=ae([]),Y=B(()=>[{prop:"id",label:n("thead.ID")},{prop:"name",label:n("thead.name")},{prop:"displayName",label:n("thead.displayName")},{prop:"icon",label:n("thead.icon")},{prop:"type",label:n("thead.type"),formatter:h=>{const i=h.type;return Ue(Me,{type:{1:"success",2:"info"}[i]},()=>n(`status.${E.value[i]}`))}},{prop:"url",label:n("thead.url"),showOverflowTooltip:!0},{prop:"orderNum",label:n("thead.orderNum")}]),j=ae({name:[{required:!0,message:n("form.nameRequired"),trigger:"blur"}],displayName:[{required:!0,message:n("form.displayNameRequired"),trigger:"blur"}],url:[{required:!0,message:n("form.urlRequired"),trigger:"blur"}]}),F=()=>{ea().then(h=>{A.value=h.data})};function U(){F(),le()}function W(h){F(),L(h)}function P(h,i){H(Qe,h,i)}function J(){S({save:Xe,update:Ze})}return(h,i)=>{const I=ve,N=je,R=Ke,D=We,te=ze,a=Ge,t=He,o=Ye,c=ia,f=Oe;return V(),z(pe,null,[re("div",da,[re("div",ma,[s(D,{inline:!0,model:e(p)},{default:m(()=>[s(N,null,{default:m(()=>[s(I,{modelValue:e(p).name,"onUpdate:modelValue":i[0]||(i[0]=r=>e(p).name=r),placeholder:e(n)("thead.name")},null,8,["modelValue","placeholder"])]),_:1}),s(N,null,{default:m(()=>[s(R,{icon:"search",type:"primary",onClick:e(G)},{default:m(()=>[M($(e(n)("action.search")),1)]),_:1},8,["onClick"])]),_:1}),s(N,null,{default:m(()=>[s(R,{icon:"plus",type:"primary",onClick:U},{default:m(()=>[M($(e(n)("action.add")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),s(te,{rowKey:"id",ref_key:"tableRef",ref:b,"get-page":e(Je),columns:e(Y),filters:e(p),showBatchDelete:!1,showPagination:!1,onHandleEdit:W,onHandleDelete:P},null,8,["get-page","columns","filters"])]),s(f,{title:e(u)?e(n)("action.edit"):e(n)("action.add"),width:"40%",draggable:"",modelValue:e(v),"onUpdate:modelValue":i[8]||(i[8]=r=>qe(v)?v.value=r:null),"close-on-click-modal":!1,onClose:e(T)},{footer:m(()=>[re("span",pa,[s(R,{onClick:e(T)},{default:m(()=>[M($(e(n)("action.cancel")),1)]),_:1},8,["onClick"]),s(R,{type:"primary",onClick:J},{default:m(()=>[M($(e(n)("action.confirm")),1)]),_:1})])]),default:m(()=>[s(D,{model:e(l),rules:e(j),ref_key:"formRef",ref:C,onKeyup:q(J,["enter"]),"label-width":"80px"},{default:m(()=>[s(N,{label:e(n)("thead.type"),prop:"type"},{default:m(()=>[s(t,{modelValue:e(l).type,"onUpdate:modelValue":i[1]||(i[1]=r=>e(l).type=r),disabled:e(u)},{default:m(()=>[(V(!0),z(pe,null,$e(e(E),(r,k)=>(V(),w(a,{value:k,key:k},{default:m(()=>[M($(e(n)(`status.${r}`)),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1},8,["label"]),s(N,{label:e(n)("thead.name"),prop:"name"},{default:m(()=>[s(I,{modelValue:e(l).name,"onUpdate:modelValue":i[2]||(i[2]=r=>e(l).name=r),placeholder:e(n)("form.nameRequired")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(N,{label:e(n)("thead.displayName"),prop:"displayName"},{default:m(()=>[s(I,{modelValue:e(l).displayName,"onUpdate:modelValue":i[3]||(i[3]=r=>e(l).displayName=r),placeholder:e(n)("form.displayNameRequired")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(l).type!==2?(V(),w(N,{key:0,label:e(n)("thead.icon")},{default:m(()=>[s(I,{modelValue:e(l).icon,"onUpdate:modelValue":i[4]||(i[4]=r=>e(l).icon=r),placeholder:e(n)("thead.icon")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):O("",!0),s(N,{label:e(n)("form.parent")},{default:m(()=>[s(o,{modelValue:e(l).parentId,"onUpdate:modelValue":i[5]||(i[5]=r=>e(l).parentId=r),props:{label:"displayName",value:"id",checkStrictly:!0,emitPath:!1},options:e(A),class:"w100p"},null,8,["modelValue","options"])]),_:1},8,["label"]),e(l).type===1?(V(),w(N,{key:1,label:e(n)("thead.url"),prop:e(l).type===1?"url":""},{default:m(()=>[s(I,{modelValue:e(l).url,"onUpdate:modelValue":i[6]||(i[6]=r=>e(l).url=r),placeholder:e(n)("thead.url")},null,8,["modelValue","placeholder"])]),_:1},8,["label","prop"])):O("",!0),e(l).type!==2?(V(),w(N,{key:2,label:e(n)("thead.orderNum"),prop:e(l).type!==2?"orderNum":""},{default:m(()=>[s(c,{modelValue:e(l).orderNum,"onUpdate:modelValue":i[7]||(i[7]=r=>e(l).orderNum=r),"controls-position":"right",min:0},null,8,["modelValue"])]),_:1},8,["label","prop"])):O("",!0)]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue","onClose"])],64)}}};export{Na as default};
