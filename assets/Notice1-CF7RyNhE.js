import{u as S,r as c,a as k,c as w,o as j,b as H,d as x,e as o,w as n,f as e,g,t as h,ah as A,F as L,x as M,E as z,j as G,aj as J}from"./index-B2sUpHKW.js";import{E as K}from"./el-dialog-BUexGnmh.js";import{E as Q}from"./el-switch-DmzcyMPI.js";import{a as X,E as Y}from"./el-form-item-JDeCQ2vQ.js";import{l as Z,u as $,s as ee}from"./sys-notice-CYr8urzA.js";const te={class:"main-body"},le={class:"toolbar"},ue={__name:"Notice1",setup(oe){const{t}=S(),f=c(),p=k({title:""}),r=c(!1),u=c(!1),b=c(!1),V=c(),i=k({id:"",title:"",content:"",isPublish:!1}),y={...i},T=[{type:"edit",disabled:a=>!!a.publishTime},{type:"delete"}],C=w(()=>[{type:"selection"},{prop:"id",label:t("thead.ID"),minWidth:50},{prop:"title",label:t("thead.title"),minWidth:120,showOverflowTooltip:!0},{prop:"content",label:t("thead.content"),minWidth:120,showOverflowTooltip:!0},{prop:"publishTime",label:t("thead.publishTime"),minWidth:120},{prop:"createdTime",label:t("thead.createdTime"),minWidth:120},{prop:"createdBy",label:t("thead.createdBy"),minWidth:120}]),R=w(()=>({title:[{required:!0,message:t("form.titleRequired"),trigger:["blur","change"]},{min:2,max:60,message:t("form.titleError"),trigger:["blur","change"]}],content:[{required:!0,message:t("form.contentRequired"),trigger:["blur","change"]},{min:2,max:300,message:t("form.contentError"),trigger:["blur","change"]}]}));function B(){f.value.reload()}function D(){r.value=!0,u.value=!1}function P(a){u.value=!0,r.value=!0;for(const l in i)l in a&&(i[l]=a[l])}function W(a,l){console.log("delete",a,l)}function F(){for(const a in y)i[a]=y[a]}function v(){r.value=!1,F()}function U(){const a={...i};return u.value||delete a.id,a}function q(){V.value.validate(a=>{if(!a)return;b.value=!0;let l;const d=U();u.value?l=$(d):l=ee(d),l.then(()=>{M({message:t("tips.success"),type:"success",showClose:!0}),v(),u.value?f.value.refresh():f.value.reload()}).finally(()=>{b.value=!1})})}return(a,l)=>{const d=z,m=X,_=G,E=Y,I=J,N=Q,O=K;return j(),H(L,null,[x("div",te,[x("div",le,[o(E,{inline:!0,model:e(p)},{default:n(()=>[o(m,null,{default:n(()=>[o(d,{modelValue:e(p).title,"onUpdate:modelValue":l[0]||(l[0]=s=>e(p).title=s),placeholder:e(t)("thead.title")},null,8,["modelValue","placeholder"])]),_:1}),o(m,null,{default:n(()=>[o(_,{icon:"search",type:"primary",onClick:B},{default:n(()=>[g(h(e(t)("action.search")),1)]),_:1})]),_:1}),o(m,null,{default:n(()=>[o(_,{icon:"plus",type:"primary",onClick:D},{default:n(()=>[g(h(e(t)("action.add")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),o(I,{ref_key:"tableRef",ref:f,"get-page":e(Z),filters:e(p),columns:e(C),operations:T,onHandleEdit:P,onHandleDelete:W},null,8,["get-page","filters","columns"])]),o(O,{title:e(u)?e(t)("action.edit"):e(t)("action.add"),width:"40%",draggable:"",modelValue:e(r),"onUpdate:modelValue":l[4]||(l[4]=s=>A(r)?r.value=s:null),"close-on-click-modal":!1,onClose:v},{footer:n(()=>[o(_,{onClick:v},{default:n(()=>[g(h(e(t)("action.cancel")),1)]),_:1}),o(_,{type:"primary",loading:e(b),onClick:q},{default:n(()=>[g(h(e(t)("action.submit")),1)]),_:1},8,["loading"])]),default:n(()=>[o(E,{ref_key:"formRef",ref:V,model:e(i),rules:e(R),"label-width":"80px","label-position":"right"},{default:n(()=>[o(m,{label:e(t)("thead.title"),prop:"title"},{default:n(()=>[o(d,{modelValue:e(i).title,"onUpdate:modelValue":l[1]||(l[1]=s=>e(i).title=s)},null,8,["modelValue"])]),_:1},8,["label"]),o(m,{label:e(t)("thead.content"),prop:"content"},{default:n(()=>[o(d,{type:"textarea",modelValue:e(i).content,"onUpdate:modelValue":l[2]||(l[2]=s=>e(i).content=s),"words-limit":300},null,8,["modelValue"])]),_:1},8,["label"]),o(m,{label:e(t)("form.publish")},{default:n(()=>[o(N,{modelValue:e(i).isPublish,"onUpdate:modelValue":l[3]||(l[3]=s=>e(i).isPublish=s)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])],64)}}};export{ue as default};
